---
title: "Mental Health and its Impact on Bullying in Schools"
output: html_notebook
---
## Abstract

While mental health has always been a factor in our education, it has only been recently that it has risen to the forefront of conversation about the impact it has on the education and school environments. In order to capture the impact mental health has on our educational systems today, we look at bullying and academic achievement to create a better picture of the drastic impact it has on our world today.

## Initial Setup
```{r}
rm(list = ls())
```

### Libraries
```{r}
library("sas7bdat")
library("tidyverse")
library("ggplot2")
library("data.table")
```

### Functions
```{r}
convertBoolean <- function(x) {
  return(x==1)
}
```

### Datasets
```{r}
schooldataraw <- read.sas7bdat("C:\\Users\\julia\\OneDrive\\Desktop\\2018109\\07_FINAL PU DATA_February 5, 2018\\pu_ssocs16.sas7bdat")
```

## Data Wrangling and Cleaning

### Cleaning the 2018-2019 School Survey on Crime and Safety
```{r}
#selecting and cleaning up the chosen variables
schooldata <-
  schooldataraw %>%
  select(C0174, C0662, C0664, C0666, C0668, C0670, C0672, C0674, C0676, C0678, C0670, C0672, C0674, C0676, C0678, C0680, C0682, C0684, C0686, C0265, C0267, C0273, C0376) %>%
  transmute(id = row_number(), antiBullying = C0174,
         assessAva = 6 - (C0662 + C0664 + C0666),
         treatAva = 6 - (C0668 + C0670 + C0672),
         limitMHProfAccess = C0674, limitFunding = C0676, limitLegal = C0678, limitParental = C0680, 
         limitComm = C0682, limitPaymentPol = C0684, limitStigma = C0686,
         discCyber = C0265, discBullying = C0267, recogBullying = C0273,
         bullyingRate = C0376)
```

```{r}
booleanRows = c(1, 12, 13, 14)

boolSchoolData <-
  lapply(schooldata[,booleanRows], convertBoolean)

schooldata[ , 1  ] <- boolSchoolData[1]
schooldata[ , 12 ] <- boolSchoolData[3]
schooldata[ , 13 ] <- boolSchoolData[4]
schooldata[ , 14 ] <- boolSchoolData[5]
```

```{r}
limitations <- data.table(comm = schooldata$limitComm, 
                          funding = schooldata$limitFunding, 
                          legal = schooldata$limitLegal, 
                          MHProfAccess = schooldata$limitMHProfAccess, 
                          parental = schooldata$limitParental, 
                          paymentPol = schooldata$limitPaymentPol, 
                          stigma = schooldata$limitStigma)
```

## Codebook
| Variable Name | Description |
| --- | --- |
| ID | The ID number of the School, given for purposes of the study |
| antiBullying | A boolean describing whether a school has anti-bullying programs put into place. |
| assessAva | An aggregate describing whether a school has mental health services for diagnostic assessment available, with a score of 3 being the highest. |
| treatAva | An aggregate describing whether a school has mental health services for treatment available, with a score of 3 being the highest. |
| limitMHProfAccess | A score describing whether inadequate access to mental health professionals was a limiting factor in the school's efforts to provide mental health services to its students, with 1 being major limitations, and 3 being no limitations. |
| limitFunding | A score describing whether inadequate funding was a limiting factor in the school's efforts to provide mental health services to its students, with 1 being major limitations, and 3 being no limitations. |
| limitLegal | A score describing whether potential legal issues, such as malpractice, or insufficient supervision were a limiting factor in the school's efforts to provide mental health services to its students, with 1 being major limitations, and 3 being no limitations. |
| limitParental | A score describing whether lack of parental support was a limiting factor in the school's efforts to provide mental health services to its students, with 1 being major limitations, and 3 being no limitations. |
| limitComm | A score describing whether lack of community support was a limiting factor in the school's efforts to provide mental health services to its students, with 1 being major limitations, and 3 being no limitations. |
| limitPaymentPol | A score describing whether payment polcies were a limiting factor in the school's efforts to provide mental health services to its students, with 1 being major limitations, and 3 being no limitations. |
| limitStigma | A score describing whether concern for potential stigmatization of the student was a limiting factor in the school's efforts to provide mental health services to its students, with 1 being major limitations, and 3 being no limitations. |
| discCyber | A boolean describing whether school staff were trained in discipline policies and practices related to cyberbullying. |
| discBullying | A boolean describing whether school staff were trained in discipline policies and practices related to bullying. |
| recogBullying | A boolean describing whether school staff were trained in recognizing bullying. |
| bullyingRate | A score describing how often bullying occurs at a school, with 1 being daily and 5 being never. |

## Analysis

### Which limitations are most limiting?
```{r}
limitationsLong <- pivot_longer(limitations, everything(), names_to = "limType")

limitationsLong %>%
  group_by(limType, value) %>%
  summarize(valCount = n()) %>%
  ggplot(aes(x = limType, y = valCount)) + 
  geom_col(aes(x = limType, y = valCount, fill = as.character(value))) +
  scale_fill_manual(values = c("tomato", "yellow2", "green2"))
```





